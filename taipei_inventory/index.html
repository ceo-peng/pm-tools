<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â∫´Â≠òÊâ£Ê∏õÁ≥ªÁµ± - Warehouse Inventory Deduction System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            font-size: 14px;
            line-height: 1.5;
            color: #333;
            background: #fff;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .section {
            background: #fff;
            border: 1px solid #eee;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #1a1a1a;
            border-bottom: 2px solid #f2c14e;
            padding-bottom: 8px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            font-weight: 500;
            margin-bottom: 6px;
            color: #555;
        }

        .form-select, .form-input {
            padding: 8px 10px;
            border: 1px solid #eee;
            border-radius: 8px;
            font-size: 13px;
            transition: all 0.2s;
            background: #fff;
        }

        .form-select:focus, .form-input:focus {
            outline: none;
            border-color: #f2c14e;
            box-shadow: 0 0 0 3px rgba(242, 193, 78, 0.1);
        }

        .filter-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 16px;
            margin-bottom: 20px;
        }

        .qty-section {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-top: 16px;
        }

        .qty-controls {
            display: flex;
            align-items: center;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }

        .qty-btn {
            background: #f8f9fa;
            border: none;
            padding: 8px 12px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
        }

        .qty-btn:hover {
            background: #e9ecef;
        }

        .qty-input {
            border: none;
            padding: 8px 12px;
            width: 60px;
            text-align: center;
            font-size: 14px;
        }

        .qty-input:focus {
            outline: none;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #f2c14e, #e6b345);
            color: #fff;
            box-shadow: 0 2px 4px rgba(242, 193, 78, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(242, 193, 78, 0.4);
        }

        .btn-secondary {
            background: #fff;
            color: #666;
            border: 1px solid #ddd;
        }

        .btn-secondary:hover {
            background: #f8f9fa;
            border-color: #ccc;
        }

        .btn-danger {
            background: #dc3545;
            color: #fff;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-success {
            background: #28a745;
            color: #fff;
        }

        .btn-success:hover {
            background: #218838;
        }

        .cart-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 12px;
        }

        .cart-table th,
        .cart-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .cart-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #555;
            font-size: 13px;
        }

        .cart-table td {
            font-size: 13px;
        }

        .cart-table td:first-child {
            font-weight: 600;
            font-size: 15px;
            width: 50%;
        }

        .cart-table td:nth-child(2) {
            width: 30%;
        }

        .cart-table td:last-child {
            width: 20%;
            text-align: right;
        }

        .order-preview {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            margin-bottom: 16px;
            overflow: hidden;
        }

        .order-preview-header {
            background: linear-gradient(135deg, #f2c14e, #e6b345);
            color: #fff;
            padding: 10px 16px;
            font-weight: 600;
            font-size: 14px;
        }

        .order-preview-content {
            padding: 12px 16px;
        }

        .preview-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 6px 0;
            border-bottom: 1px solid #e9ecef;
            font-size: 13px;
        }

        .preview-row:last-child {
            border-bottom: none;
        }

        .preview-label {
            font-weight: 500;
            color: #495057;
            min-width: 120px;
        }

        .preview-value {
            color: #212529;
            font-weight: 500;
        }

        .cart-summary {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-top: 2px solid #f2c14e;
            margin-top: 12px;
            font-size: 13px;
        }

        .summary-item {
            font-weight: 500;
        }

        .cart-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .import-section {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-top: 40px;
        }

        .import-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #495057;
        }

        .import-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .import-textarea {
            width: 100%;
            height: 120px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: monospace;
            font-size: 13px;
            resize: vertical;
        }

        .import-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 8px;
            color: #fff;
            font-weight: 500;
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.3s;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            background: #28a745;
        }

        .toast.error {
            background: #dc3545;
        }

        @media (max-width: 860px) {
            .container {
                padding: 16px;
            }

            .form-grid,
            .filter-grid {
                grid-template-columns: 1fr;
            }

            .import-grid {
                grid-template-columns: 1fr;
            }

            .cart-actions {
                flex-direction: column;
            }

            .cart-summary {
                flex-direction: column;
                gap: 8px;
                align-items: flex-start;
            }

            .import-buttons {
                justify-content: stretch;
            }

            .import-buttons .btn {
                flex: 1;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Âá∫Ë≤®Ë®ÇÂñÆË≥áË®ä -->
        <div class="section">
            <h2 class="section-title">üì¶ Âá∫Ë≤®Ë®ÇÂñÆË≥áË®ä</h2>
            
            <!-- Ê®°ÂºèÂàáÊèõËàáÈáçÁΩÆÊåâÈàï -->
            <div class="form-group" style="margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <label class="form-label">‰ΩúÊ•≠Ê®°Âºè</label>
                        <div style="display: flex; gap: 20px; align-items: center; margin-top: 8px;">
                            <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                                <input type="radio" name="mode" value="sales" checked id="modeSales">
                                <span>Èä∑ÂîÆ (Sales)</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                                <input type="radio" name="mode" value="non_sales" id="modeNonSales">
                                <span>ÈùûÈä∑ÂîÆ (Non-Sales)</span>
                            </label>
                        </div>
                    </div>
                    <button id="btnReset" class="btn btn-danger" style="height: fit-content; padding: 6px 12px; font-size: 13px;">üîÑ ÈáçÁΩÆË≥áÊñô</button>
                </div>
            </div>
            
            <div class="form-grid">
                <div class="form-group" id="groupCustomer">
                    <label for="selCustomer" class="form-label">Âá∫Ë≤®ÂÆ¢Êà∂</label>
                    <select id="selCustomer" class="form-select">
                        <option value="">Ë´ãÈÅ∏ÊìáÂá∫Ë≤®ÂÆ¢Êà∂</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="po" class="form-label">PO Âá∫Ë≤®ÂñÆËôü</label>
                    <input type="text" id="po" class="form-input" placeholder="Ë´ãËº∏ÂÖ• PO Âá∫Ë≤®ÂñÆËôü">
                </div>
            </div>
            
            <!-- ÈùûÈä∑ÂîÆÂ∞àÁî®Ê¨Ñ‰Ωç -->
            <div id="nonSalesFields" style="display: none;">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="selNonSalesCategory" class="form-label">ÈùûÈä∑ÂîÆÈ°ûÂà•</label>
                        <select id="selNonSalesCategory" class="form-select">
                            <option value="">Ë´ãÈÅ∏ÊìáÈ°ûÂà•</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="selUrgency" class="form-label">Á∑äÊÄ•Á®ãÂ∫¶</label>
                        <select id="selUrgency" class="form-select">
                            <option value="0">‰∏ÄËà¨ (0)</option>
                            <option value="1">Á∑äÊÄ• (1)</option>
                            <option value="2">ÁâπÊÄ• (2)</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="txtNote" class="form-label">ÂÇôË®ª</label>
                    <textarea id="txtNote" class="form-input" style="min-height: 80px;" placeholder="Ë´ãËº∏ÂÖ•ÂÇôË®ª"></textarea>
                </div>
            </div>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="formDateId" class="form-label">Âá∫Ë≤®ÂñÆ_Êó•Êúü_ID</label>
                    <input type="text" id="formDateId" class="form-input" readonly placeholder="Ëá™ÂãïÁîüÊàê">
                </div>
            </div>
        </div>

        <!-- Â∫´Â≠òÊâ£Ê∏õÂïÜÂìÅÊ∏ÖÂñÆ -->
        <div class="section">
            <h2 class="section-title">üìã Âá∫Ë≤®ÂïÜÂìÅÊåëÈÅ∏ (Â∫´Â≠òÊâ£Ê∏õ)</h2>
            
            <!-- Â•óÁµÑÈÅ∏Êìá -->
            <div style="background: #fefefe; border: 1px solid #eee; border-radius: 8px; padding: 16px; margin-bottom: 20px;">
                <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 12px; color: #333;">üéÅ Â•óÁµÑÈÅ∏Êìá</h3>
                <div style="display: flex; gap: 12px; align-items: end; flex-wrap: wrap;">
                    <div class="form-group" style="min-width: 200px; margin-bottom: 0;">
                        <label for="selBundle" class="form-label">ÈÅ∏ÊìáÂ•óÁµÑ</label>
                        <select id="selBundle" class="form-select">
                            <option value="">Ë´ãÈÅ∏ÊìáÂ•óÁµÑ</option>
                        </select>
                    </div>
                    <div class="form-group" style="min-width: 100px; margin-bottom: 0;">
                        <label for="bundleQty" class="form-label">Â•óÁµÑÊï∏Èáè</label>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <button id="bundleDec" class="qty-btn">‚àí</button>
                            <input type="number" id="bundleQty" class="qty-input" value="1" min="1" style="width: 60px;">
                            <button id="bundleInc" class="qty-btn">+</button>
                        </div>
                    </div>
                    <button id="btnAddBundle" class="btn btn-primary" style="height: fit-content;">Âä†ÂÖ•Â•óÁµÑ</button>
                </div>
            </div>
            
            <div class="filter-grid">
                <div class="form-group">
                    <label for="selCategory" class="form-label">ÂïÜÂìÅÂìÅÈ°û</label>
                    <select id="selCategory" class="form-select">
                        <option value="">ÂÖ®ÈÉ®ÂìÅÈ°û</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="selSeries" class="form-label">ÂïÜÂìÅÁ≥ªÂàó</label>
                    <select id="selSeries" class="form-select">
                        <option value="">ÂÖ®ÈÉ®Á≥ªÂàó</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="selProduct" class="form-label">ÂïÜÂìÅÂêçÁ®±</label>
                    <select id="selProduct" class="form-select">
                        <option value="">Ë´ãÈÅ∏ÊìáÂá∫Ë≤®ÂïÜÂìÅ</option>
                    </select>
                </div>
            </div>
            <!-- ÂÖ•/Âá∫Â∫´ÂàáÊèõ -->
            <div id="opSignSection" class="qty-section" style="margin-bottom: 16px;">
                <label class="form-label">Êìç‰ΩúÈ°ûÂûãÔºö</label>
                <div style="display: flex; gap: 20px; align-items: center;">
                    <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                        <input type="radio" name="opSign" value="sub" checked id="opSignSub">
                        <span>Âá∫Ë≤® (‚àí)</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                        <input type="radio" name="opSign" value="add" id="opSignAdd">
                        <span>ÈÄ≤Ë≤® (+)</span>
                    </label>
                </div>
            </div>
            
            <div class="qty-section">
                <label class="form-label">Êï∏ÈáèÔºö</label>
                <div class="qty-controls">
                    <button id="dec" class="qty-btn">‚àí</button>
                    <input type="number" id="qty" class="qty-input" value="1" min="1">
                    <button id="inc" class="qty-btn">+</button>
                </div>
                <button id="addBtn" class="btn btn-primary">Âä†ÂÖ•Ê∏ÖÂñÆ</button>
            </div>
        </div>

        <!-- Âá∫Ë≤®Ê∏ÖÂñÆÈ†êË¶Ω -->
        <div class="section">
            <h2 class="section-title">üì¶ Âá∫Ë≤®Ê∏ÖÂñÆÈ†êË¶Ω (Â∫´Â≠òÊâ£Ê∏õÁ¢∫Ë™ç)</h2>
            
            <!-- Âá∫Ë≤®Ë®ÇÂñÆË≥áË®äÈ†êË¶Ω -->
            <div class="order-preview">
                <div class="order-preview-header">
                    <h3>üìã Âá∫Ë≤®Ë®ÇÂñÆË≥áË®ä</h3>
                </div>
                <div class="order-preview-content">
                    <div class="preview-row">
                        <span class="preview-label">Âá∫Ë≤®ÂÆ¢Êà∂:</span>
                        <span id="previewCustomer" class="preview-value">Ë´ãÈÅ∏ÊìáÂÆ¢Êà∂</span>
                    </div>
                    <div class="preview-row">
                        <span class="preview-label">PO Âá∫Ë≤®ÂñÆËôü:</span>
                        <span id="previewPO" class="preview-value">Ë´ãËº∏ÂÖ• PO Á∑®Ëôü</span>
                    </div>
                    <div class="preview-row">
                        <span class="preview-label">Âá∫Ë≤®ÂñÆ_Êó•Êúü_ID:</span>
                        <span id="previewFormDateId" class="preview-value">ÂæÖÁîüÊàê</span>
                    </div>
                    <div class="preview-row">
                        <span class="preview-label">Á∑äÊÄ•Á®ãÂ∫¶:</span>
                        <span id="previewUrgency" class="preview-value">‰∏ÄËà¨</span>
                    </div>
                    <div class="preview-row">
                        <span class="preview-label">ÂÇôË®ª:</span>
                        <span id="previewNote" class="preview-value">ÁÑ°</span>
                    </div>
                </div>
            </div>
            
            <table id="cartTable" class="cart-table">
                <thead>
                    <tr>
                        <th>ÂïÜÂìÅÂêçÁ®±</th>
                        <th>Âá∫Ë≤®Êï∏Èáè</th>
                        <th>Êìç‰Ωú</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
            <div class="cart-summary">
                <div class="summary-item">Á∏ΩÈ†ÖÁõÆÔºö<span id="totalItems">0</span> È†Ö</div>
                <div class="summary-item">Á∏ΩÂá∫Ë≤®Êï∏ÈáèÔºö<span id="totalQty">0</span> ‰ª∂</div>
            </div>
            <div class="cart-actions">
                <button id="btnClear" class="btn btn-secondary">Ê∏ÖÁ©∫Ê∏ÖÂñÆ</button>
                <button id="btnSubmit" class="btn btn-success">üöÄ Êèê‰∫§Â∫´Â≠òÊâ£Ê∏õ</button>
            </div>
        </div>

        <!-- ÂåØÂÖ•Ë≥áÊñô -->
        <div class="import-section">
            <h3 class="import-title">üì• ÂåØÂÖ•Ë≥áÊñôÔºàÁ≥ªÁµ±Áî®Ôºâ</h3>
            <div class="import-grid">
                <div class="form-group">
                    <label for="csvABC" class="form-label">ÂïÜÂìÅ CSV (A,B,C)</label>
                    <textarea id="csvABC" class="import-textarea" placeholder="ÂìÅÈ°û,Á≥ªÂàó,Áî¢ÂìÅ&#10;ÈõªÂ≠êÁî¢ÂìÅ,ÊâãÊ©ü,iPhone 15&#10;ÈõªÂ≠êÁî¢ÂìÅ,Âπ≥Êùø,iPad Pro"></textarea>
                </div>
                <div class="form-group">
                    <label for="csvCus" class="form-label">ÂÆ¢Êà∂ CSV (id,name)</label>
                    <textarea id="csvCus" class="import-textarea" placeholder="id,name&#10;C001,ÂÆ¢Êà∂A&#10;C002,ÂÆ¢Êà∂B"></textarea>
                </div>
            </div>
            <div class="import-buttons">
                <button id="btnParseABC" class="btn btn-secondary">ËºâÂÖ•ÂïÜÂìÅ</button>
                <button id="btnParseCus" class="btn btn-secondary">ËºâÂÖ•ÂÆ¢Êà∂</button>
                <button id="btnOverwriteAll" class="btn btn-primary">Ê∏ÖÈô§ËàäË≥áÊñô‰∏¶Ë¶ÜËìã</button>
                <button id="btnClearLocal" class="btn btn-danger">Ê∏ÖÈô§Êú¨Ê©üÂÑ≤Â≠ò</button>
            </div>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <script>
        // Â∏∏Êï∏ÂÆöÁæ©
        const WEBHOOK_URL = "https://hook.us2.make.com/nbjdxrfypgoosj4qqxnzfmj9o29jq3c2";
        const STORAGE_KEY = "pm_order_data_v2";
        
        // ÈùûÈä∑ÂîÆÈ°ûÂà•Â∏∏Êï∏ - ‰ΩøÁî®‰∏≠Êñá‰ΩúÁÇ∫ÂîØ‰∏ÄÂÄº
        const NON_SALES_CATEGORIES = [
            { id:'ÈÄÄÂ∫´',         name:'ÈÄÄÂ∫´', defaultSign:'minus',  order:1 },
            { id:'Áõ§Èªû',          name:'Áõ§Èªû', defaultSign:'any',   order:2 },
            { id:'Ë°åÈä∑',       name:'Ë°åÈä∑', defaultSign:'minus', order:3 },
            { id:'ÂÆ¢ÈÄÄ', name:'ÂÆ¢ÈÄÄ', defaultSign:'plus',  order:4 },
            { id:'Ê≠∏ÂÄâ',           name:'Ê≠∏ÂÄâ', defaultSign:'plus',   order:5 },
            { id:'ÂÖ∂‰ªñ',           name:'ÂÖ∂‰ªñ', defaultSign:'any',   order:6 }
        ];
        
        // ÂÖ®ÂüüËÆäÊï∏
        let MODE = 'sales';

        // È†êË®≠Ë≥áÊñôÔºàÁ°¨Á∑®Á¢ºÔºâ
        const PRODUCTS_DEFAULT_CSV = `Ê≠£ÂìÅ(Â§ß),ÈáëËêÉÊ≤π,‰ªô‰∫∫ÊéåÁ±ΩË∂ÖËÉΩÈáèÈáëËêÉÊ≤π 15ml (2027-07-30)
Ê≠£ÂìÅ(ÊóÖ),ÈáëËêÉÊ≤π,‰ªô‰∫∫ÊéåÁ±ΩË∂ÖËÉΩÈáèÈáëËêÉÊ≤π 5ml (2027-05-10)
Ê≠£ÂìÅ(È´î),ÈáëËêÉÊ≤π,‰ªô‰∫∫ÊéåÁ±ΩË∂ÖËÉΩÈáèÈáëËêÉÊ≤π 1.5ml (2025-09-28)
Ê≠£ÂìÅ(È´î),ÈáëËêÉÊ≤π,‰ªô‰∫∫ÊéåÁ±ΩË∂ÖËÉΩÈáèÈáëËêÉÊ≤π 1.5ml (2026-05-29)
Ê≠£ÂìÅ(Â§ß),ÈáëËêÉÊ≤π,Êë©Ê¥õÂì•Â†ÖÊûúË≥¶Ê¥ªÈáëËêÉÊ≤π 28ml (2027-04-08)
Ê≠£ÂìÅ(Â§ß),ÈáëËêÉÊ≤π,Êë©Ê¥õÂì•Â†ÖÊûúË≥¶Ê¥ªÈáëËêÉÊ≤π 28ml (2027-10-08)
Ê≠£ÂìÅ(ÊóÖ),ÈáëËêÉÊ≤π,Êë©Ê¥õÂì•Â†ÖÊûúË≥¶Ê¥ªÈáëËêÉÊ≤π 5ml (2026-09-30)
Ê≠£ÂìÅ(ÊóÖ),ÈáëËêÉÊ≤π,Êë©Ê¥õÂì•Â†ÖÊûúË≥¶Ê¥ªÈáëËêÉÊ≤π 5ml (2028-07-22)
Ê≠£ÂìÅ(È´î),ÈáëËêÉÊ≤π,Êë©Ê¥õÂì•Â†ÖÊûúË≥¶Ê¥ªÈáëËêÉÊ≤π 1.5ml (2025-09-28)
Ê≠£ÂìÅ(È´î),ÈáëËêÉÊ≤π,Êë©Ê¥õÂì•Â†ÖÊûúË≥¶Ê¥ªÈáëËêÉÊ≤π 1.5ml (2026-05-29)
Ê≠£ÂìÅ(Â§ß),Ë∂ÖÁ¥öË§áÊñπÊ≤π,Ë∂ÖÁ¥öË§áÊñπÊ≤π Áé´Áë∞ÁÖ•È°è 28ml (2027-04-10)
Ê≠£ÂìÅ(Â§ß),Ë∂ÖÁ¥öË§áÊñπÊ≤π,Ë∂ÖÁ¥öË§áÊñπÊ≤π Áé´Áë∞ÁÖ•È°è 28ml (2027-10-08)
Ê≠£ÂìÅ(ÊóÖ),Ë∂ÖÁ¥öË§áÊñπÊ≤π,Ë∂ÖÁ¥öË§áÊñπÊ≤π Áé´Áë∞ÁÖ•È°è 5ml (2025-08-08)
Ê≠£ÂìÅ(ÊóÖ),Ë∂ÖÁ¥öË§áÊñπÊ≤π,Ë∂ÖÁ¥öË§áÊñπÊ≤π Áé´Áë∞ÁÖ•È°è 5ml (2026-09-30)
Ê≠£ÂìÅ(È´î),Ë∂ÖÁ¥öË§áÊñπÊ≤π,Ë∂ÖÁ¥öË§áÊñπÊ≤π Áé´Áë∞ÁÖ•È°è 1.5ml (2025-09-28)
Ê≠£ÂìÅ(È´î),Ë∂ÖÁ¥öË§áÊñπÊ≤π,Ë∂ÖÁ¥öË§áÊñπÊ≤π Áé´Áë∞ÁÖ•È°è 1.5ml (2026-05-29)
Ê≠£ÂìÅ(Â§ß),Ë∂ÖÁ¥öË§áÊñπÊ≤π,Ë∂ÖÁ¥öË§áÊñπÊ≤π ËéìÊûú‰∫ÆÈáá 28ml (2026-02-20)
Ê≠£ÂìÅ(Â§ß),Ë∂ÖÁ¥öË§áÊñπÊ≤π,Ë∂ÖÁ¥öË§áÊñπÊ≤π ËéìÊûú‰∫ÆÈáá 28ml (2027-04-10)
Ê≠£ÂìÅ(ÊóÖ),Ë∂ÖÁ¥öË§áÊñπÊ≤π,Ë∂ÖÁ¥öË§áÊñπÊ≤π ËéìÊûú‰∫ÆÈáá 5ml (2025-08-08)
Ê≠£ÂìÅ(ÊóÖ),Ë∂ÖÁ¥öË§áÊñπÊ≤π,Ë∂ÖÁ¥öË§áÊñπÊ≤π ËéìÊûú‰∫ÆÈáá 5ml (2026-09-30)
Ê≠£ÂìÅ(È´î),Ë∂ÖÁ¥öË§áÊñπÊ≤π,Ë∂ÖÁ¥öË§áÊñπÊ≤π ËéìÊûú‰∫ÆÈáá 1.5ml (2025-09-28)
Ê≠£ÂìÅ(È´î),Ë∂ÖÁ¥öË§áÊñπÊ≤π,Ë∂ÖÁ¥öË§áÊñπÊ≤π ËéìÊûú‰∫ÆÈáá 1.5ml (2026-05-29)
Ê≠£ÂìÅ(Â§ß),ÁæéÈ´îÊ•µËêÉÊ≤π,ÁæéÈ´îÊ•µËêÉÊ≤π ‰øùÊøïÈÄèÁôΩ 120ml (2028-05-08)
Ê≠£ÂìÅ(ÊóÖ),ÁæéÈ´îÊ•µËêÉÊ≤π,ÁæéÈ´îÊ•µËêÉÊ≤π ‰øùÊøïÈÄèÁôΩ 4ml (2028-12-20)
Ê≠£ÂìÅ(Â§ß),ÁæéÈ´îÊ•µËêÉÊ≤π,ÁæéÈ´îÊ•µËêÉÊ≤π Ë≥¶Ê¥ª‰øÆË≠∑ 120ml (2028-05-08)
Ê≠£ÂìÅ(ÊóÖ),ÁæéÈ´îÊ•µËêÉÊ≤π,ÁæéÈ´îÊ•µËêÉÊ≤π Ë≥¶Ê¥ª‰øÆË≠∑ 4ml (2028-12-20)
Ê≠£ÂìÅ(Â§ß),Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤,Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤ ÈéñÊ∞¥‰∫ÆÊæ§ 120ml (2028-10-16)
Ê≠£ÂìÅ(ÊóÖ),Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤,Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤ ÈéñÊ∞¥‰∫ÆÊæ§ 5ml (2026-06-13)
Ê≠£ÂìÅ(ÊóÖ),Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤,Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤ ÈéñÊ∞¥‰∫ÆÊæ§ 5ml (2028-04-26)
Ê≠£ÂìÅ(È´î),Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤,Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤ ÈéñÊ∞¥‰∫ÆÊæ§ 2ml (2026-09-28)
Ê≠£ÂìÅ(Â§ß),Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤,Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤ ÈáëÁá¶Á∑äÂØ¶ 120ml (2028-10-16)
Ê≠£ÂìÅ(ÊóÖ),Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤,Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤ ÈáëÁá¶Á∑äÂØ¶ 5ml (2026-06-13)
Ê≠£ÂìÅ(ÊóÖ),Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤,Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤ ÈáëÁá¶Á∑äÂØ¶ 5ml (2027-10-16)
Ê≠£ÂìÅ(È´î),Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤,Ë∂ÖËÉΩÂâçÂ∞éÁ≤æËèØÈú≤ ÈáëÁá¶Á∑äÂØ¶ 2ml (2026-09-28)
Ê≠£ÂìÅ(Â§ß),ÂÆåÁæéÊ•µËêÉÈù¢ËÜú,ÂÆåÁæéÊ•µËêÉÈù¢ËÜú ÈéñÊ∞¥ËÉΩÈáè(‰∫îÂÖ•ÁµÑ) (2025-05-26)
Ê≠£ÂìÅ(Â§ß),ÂÆåÁæéÊ•µËêÉÈù¢ËÜú,ÂÆåÁæéÊ•µËêÉÈù¢ËÜú ÈéñÊ∞¥ËÉΩÈáè(‰∫îÂÖ•ÁµÑ) (2028-08-12)
Ê≠£ÂìÅ(ÊóÖ),ÂÆåÁæéÊ•µËêÉÈù¢ËÜú,ÂÆåÁæéÊ•µËêÉÈù¢ËÜú ÈéñÊ∞¥ËÉΩÈáè(ÂñÆÁâá) (2028-08-12)
Ê≠£ÂìÅ(Â§ß),ÂÆåÁæéÊ•µËêÉÈù¢ËÜú,ÂÆåÁæéÊ•µËêÉÈù¢ËÜú ÈÄè‰∫ÆËÉΩÈáè(‰∫îÂÖ•ÁµÑ) (2025-05-26)
Ê≠£ÂìÅ(Â§ß),ÂÆåÁæéÊ•µËêÉÈù¢ËÜú,ÂÆåÁæéÊ•µËêÉÈù¢ËÜú ÈÄè‰∫ÆËÉΩÈáè(‰∫îÂÖ•ÁµÑ) (2028-08-12)
Ê≠£ÂìÅ(ÊóÖ),ÂÆåÁæéÊ•µËêÉÈù¢ËÜú,ÂÆåÁæéÊ•µËêÉÈù¢ËÜú ÈÄè‰∫ÆËÉΩÈáè(ÂñÆÁâá) (2028-08-12)
Ê≠£ÂìÅ(Â§ß),ÂÆåÁæéÊ•µËêÉÈù¢ËÜú,ÂÆåÁæéÊ•µËêÉÈù¢ËÜú Ë≥¶Ê¥ªËÉΩÈáè(‰∫îÂÖ•ÁµÑ) (2025-05-24)
Ê≠£ÂìÅ(Â§ß),ÂÆåÁæéÊ•µËêÉÈù¢ËÜú,ÂÆåÁæéÊ•µËêÉÈù¢ËÜú Ë≥¶Ê¥ªËÉΩÈáè(‰∫îÂÖ•ÁµÑ) (2028-08-12)
Ê≠£ÂìÅ(ÊóÖ),ÂÆåÁæéÊ•µËêÉÈù¢ËÜú,ÂÆåÁæéÊ•µËêÉÈù¢ËÜú Ë≥¶Ê¥ªËÉΩÈáè(ÂñÆÁâá) (2028-08-12)
Ê≠£ÂìÅ(Â§ß),ÂÆåÁæéÊ•µËêÉÈù¢ËÜú,ÂÆåÁæéÊ•µËêÉÈù¢ËÜú ‰∏âÊó•È©öË±îÁµÑ(‰∏âÂÖ•ÁµÑ) (2028-08-12)
Ê≠£ÂìÅ(Â§ß),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩ‰ªô‰∫∫ÊéåÁ±ΩÈáëËêÉÊ≤πÊ•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2026-10-02)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩ‰ªô‰∫∫ÊéåÁ±ΩÈáëËêÉÊ≤πÊ•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2027-08-23)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩ‰ªô‰∫∫ÊéåÁ±ΩÈáëËêÉÊ≤πÊ•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2028-05-30)
Ê≠£ÂìÅ(Â§ß),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÊë©Ê¥õÂì•Â†ÖÊûúÈáëËêÉÊ≤πÊ•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2025-08-29)
Ê≠£ÂìÅ(Â§ß),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÊë©Ê¥õÂì•Â†ÖÊûúÈáëËêÉÊ≤πÊ•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2026-10-02)
Ê≠£ÂìÅ(Â§ß),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÊë©Ê¥õÂì•Â†ÖÊûúÈáëËêÉÊ≤πÊ•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2028-05-30)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÊë©Ê¥õÂì•Â†ÖÊûúÈáëËêÉÊ≤πÊ•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2025-08-29)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÊë©Ê¥õÂì•Â†ÖÊûúÈáëËêÉÊ≤πÊ•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2027-08-23)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÊë©Ê¥õÂì•Â†ÖÊûúÈáëËêÉÊ≤πÊ•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2028-05-30)
Ê≠£ÂìÅ(Â§ß),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁµï‰∏ñÁï™Á¥ÖËä±Ê•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2025-08-29)
Ê≠£ÂìÅ(Â§ß),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁµï‰∏ñÁï™Á¥ÖËä±Ê•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2026-10-02)
Ê≠£ÂìÅ(Â§ß),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁµï‰∏ñÁï™Á¥ÖËä±Ê•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2028-05-30)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁµï‰∏ñÁï™Á¥ÖËä±Ê•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2025-08-29)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁµï‰∏ñÁï™Á¥ÖËä±Ê•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2027-08-23)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁµï‰∏ñÁï™Á¥ÖËä±Ê•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2028-05-30)
Ê≠£ÂìÅ(Â§ß),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁöáÂÆ∂Â§ßÈ¶¨Â£´Èù©Áé´Áë∞Ê•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2025-08-29)
Ê≠£ÂìÅ(Â§ß),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁöáÂÆ∂Â§ßÈ¶¨Â£´Èù©Áé´Áë∞Ê•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2026-10-02)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁöáÂÆ∂Â§ßÈ¶¨Â£´Èù©Áé´Áë∞Ê•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2025-08-29)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁöáÂÆ∂Â§ßÈ¶¨Â£´Èù©Áé´Áë∞Ê•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2027-08-23)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁöáÂÆ∂Â§ßÈ¶¨Â£´Èù©Áé´Áë∞Ê•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2028-05-30)
Ê≠£ÂìÅ(Â§ß),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÈáëÁá¶ËñëÈªÉËúÇËúúÊ•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2025-08-29)
Ê≠£ÂìÅ(Â§ß),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÈáëÁá¶ËñëÈªÉËúÇËúúÊ•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2026-10-02)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÈáëÁá¶ËñëÈªÉËúÇËúúÊ•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2027-08-23)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÈáëÁá¶ËñëÈªÉËúÇËúúÊ•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2028-05-30)
Ê≠£ÂìÅ(Â§ß),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁÖ•ÈááÊ¥ªÊÄßÁÇ≠Ê•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2025-08-29)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁÖ•ÈááÊ¥ªÊÄßÁÇ≠Ê•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2026-10-02)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁÖ•ÈááÊ¥ªÊÄßÁÇ≠Ê•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2028-05-30)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁÖ•ÈááÊ¥ªÊÄßÁÇ≠Ê•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2025-08-29)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁÖ•ÈááÊ¥ªÊÄßÁÇ≠Ê•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2027-08-23)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÁÖ•ÈááÊ¥ªÊÄßÁÇ≠Ê•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2028-05-30)
Ê≠£ÂìÅ(Â§ß),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÊô∂‰∫ÆÈªëÁ®ÆËçâÁ±ΩÊ≤πÊ•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2026-10-02)
Ê≠£ÂìÅ(Â§ß),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÊô∂‰∫ÆÈªëÁ®ÆËçâÁ±ΩÊ≤πÊ•µÁ∑ªÊΩîÈ°èÁöÇ 120g (2028-05-30)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÊô∂‰∫ÆÈªëÁ®ÆËçâÁ±ΩÊ≤πÊ•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2025-08-29)
Ê≠£ÂìÅ(ÊóÖ),Êô∂ÈëΩÊ•µÁ∑ªÊΩîÈ°èÁöÇ,Êô∂ÈëΩÊô∂‰∫ÆÈªëÁ®ÆËçâÁ±ΩÊ≤πÊ•µÁ∑ªÊΩîÈ°èÁöÇ 25g (2028-05-30)
Ê≠£ÂìÅ(È´î),È´îÈ©óÁµÑ,ÈâëÁø°ÊñØÈáëËâ≤Ê∏õÊ≥ï‰øùÈ§ä_‰ªôÊ≤πÂãªÊ∑®È´îÈ©óÁµÑ (2025-09-28)
Ê≠£ÂìÅ(È´î),È´îÈ©óÁµÑ,ÈâëÁø°ÊñØÈáëËâ≤Ê∏õÊ≥ï‰øùÈ§ä_Êë©Ê≤πÊΩ§Êæ§È´îÈ©óÁµÑ (2025-09-28)
Ê≠£ÂìÅ(È´î),È´îÈ©óÁµÑ,ÈâëÁø°ÊñØÈáëËâ≤Ê∏õÊ≥ï‰øùÈ§ä_Áé´Áë∞ÁÖ•È°èÈ´îÈ©óÁµÑ (2025-09-28)
Ê≠£ÂìÅ(È´î),È´îÈ©óÁµÑ,ÈâëÁø°ÊñØÈáëËâ≤Ê∏õÊ≥ï‰øùÈ§ä_ËéìÊûú‰∫ÆÈááÈ´îÈ©óÁµÑ (2025-09-28)
ÂåÖÊùê,ÂìÅÁâåPizzaÁõí,ÈâëÁø°ÊñØ PIZZAÁõí-‰∏≠ (28.5*23*9 cm)
ÂåÖÊùê,ÂìÅÁâåPizzaÁõí,ÈâëÁø°ÊñØ PIZZAÁõí-Â∞è (20*20*7.5 cm)
ÂåÖÊùê,ÂìÅÁâåÁ¥ôÁÆ±,ÈâëÁø°ÊñØ‰∏âÊèíËàåÁ¥ôÁÆ±-Â§ß (38*38*21 cm)
ÂåÖÊùê,ÂìÅÁâåË£Ω‰ΩúÁâ©,ÂìÅÁâåÁ¥ôË¢ã-ÁôΩ L (40.5*14*31.5 cm)
ÂåÖÊùê,ÂìÅÁâåË£Ω‰ΩúÁâ©,ÂìÅÁâåÁ¥ôË¢ã-ÁôΩ M (20.5*11*25 cm)
ÂåÖÊùê,ÂìÅÁâåË£Ω‰ΩúÁâ©,ÂìÅÁâåÁ¥ôË¢ã-ÁôΩ S (14.5*8.5*19 cm)
ÂåÖÊùê,ÂìÅÁâåË£Ω‰ΩúÁâ©,ÂìÅÁâåË•ØÁ¥ô (ÊèíÁï´Ê¨æ)
ÂåÖÊùê,ÂìÅÁâåË£Ω‰ΩúÁâ©,ÂìÅÁâå‰ø°Â∞ÅË¢ã-Á¥Ö (12.5*7.5 cm)
ÂåÖÊùê,ÂìÅÁâåË£Ω‰ΩúÁâ©,OPPÔºöÁ≤æË£ùÁõí (6.9*44 cm)
ÂåÖÊùê,ÂìÅÁâåË£Ω‰ΩúÁâ©,OPPÔºöÂâçÂ∞éÊ∂≤ (26.1*16.5 cm)
ÂåÖÊùê,ÂìÅÁâåË£Ω‰ΩúÁâ©,OPPÔºöË∫´È´îÊ≤π (27*16.6 cm)
ÂåÖÊùê,ÂìÅÁâåË£Ω‰ΩúÁâ©,OPPÔºöÈù¢ËÜú/ÈáëËâ≤‰øùÈ§äÈ´îÈ©óÂç°ÂÖ±Áî® (13*42 cm)
Ë≤ºÁ¥ô,ÂìÅÁâåË≤ºÁ¥ô,ÂúìÂΩ¢ÈúßÈù¢Ë≤º (1*1 cm)
Ë≤ºÁ¥ô,ÂìÅÁâåË≤ºÁ¥ô,ÂúìÂΩ¢ÈúßÈù¢Ë≤º (2*2 cm)
Ë≤ºÁ¥ô,ÂìÅÁâåË≤ºÁ¥ô,ÈáëËâ≤Â§ßÁöáÂÜ†Ë≤ºÁ¥ô (5*5 cm)
Ë≤ºÁ¥ô,ÂìÅÁâåË≤ºÁ¥ô,ÈáëËâ≤Â∞èÁöáÂÜ†Ë≤ºÁ¥ô (2*2 cm)
Ë≤ºÁ¥ô,ÂìÅÁâåË≤ºÁ¥ô,ÁöáÂÜ†Ë≤ºÁ¥ô-Èõ∑Â∞ÑÁ¥ô
Ë≤ºÁ¥ô,‰∏≠ÊñáÊ®ô,‰∏≠ÊñáÊ®ôÔºö‰ªô‰∫∫ÊéåÁ±ΩË∂ÖËÉΩÈáèÈáëËêÉÊ≤π15ml (5.5*4.5 cm)
Ë≤ºÁ¥ô,‰∏≠ÊñáÊ®ô,‰∏≠ÊñáÊ®ôÔºöÊë©Ê¥õÂì•Â†ÖÊûúË≥¶Ê¥ªÈáëËêÉÊ≤π 28ml (5.5*4.5 cm)
Ë≤ºÁ¥ô,‰∏≠ÊñáÊ®ô,‰∏≠ÊñáÊ®ôÔºöË∂ÖÁ¥öË§áÊñπÊ≤π Áé´Áë∞ÁÖ•È°è 28ml (5.5*4.5 cm)
Ë≤ºÁ¥ô,‰∏≠ÊñáÊ®ô,‰∏≠ÊñáÊ®ôÔºöË∂ÖÁ¥öË§áÊñπÊ≤π ËéìÊûú‰∫ÆÈáá 28ml (5.5*4.5 cm)
Âç∞Âà∑ÂìÅ,DM,202312Áâà_ÁæéÈ´îÊ≤πDM
Âç∞Âà∑ÂìÅ,DM,202407Áâà_ÂÖ®Áî¢ÂìÅDM
Âç∞Âà∑ÂìÅ,DM,Ê≤π‰øùÈ§ä‰ΩøÁî®ÊåáÂçóÂ∞èÂç°
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,Ê∞∏ÊÅÜÁø°ÂÑ∑Á∂ìÂÖ∏ÁúüÁöÆÂåñÂ¶ùÂåÖ
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,ÊΩõÈÅäÂéüÊ£â‰ªô‰∫∫ÊéåÊâòÁâπÂåÖ (38*42 cm)
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,Ë∂ÖËÉΩÈáèÂéüÊ£âÊâòÁâπÂåÖÁ≥ªÂàó-Ëø∑‰Ω†ÊâãÊèê (16*12 cm)
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,Áø°Áø†ÂøÉË™ûÂ§öÂäüËÉΩÊãâÊèêÊùø
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,Ê∞∏ÊÅÜÁ∂ìÂÖ∏ÁúüÁöÆÁè†ÂØ∂Áõ§Á≥ªÂàó-ÂìÅÁâåÁ∂†
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,Ê∞∏ÊÅÜÁ∂ìÂÖ∏ÁúüÁöÆÁè†ÂØ∂Áõ§Á≥ªÂàó-Â†ÖÊûúÈªÉ
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,ÂìÅÁâåÁöÆÂ•ó (Á∂†) 8*8cm
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,TÂûãÊåâÊë©Ê£íÁöÆÂ•óÁµÑ
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,Êô∂ÈëΩÊâãÂ∑•ÁöÇÁ¢ü
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,„ÄåÊë©Ê¥õËóùÂ¢É„ÄçÈô∂Áì∑ÊùØÂ¢ä Á≥ªÂàó  È°èËâ≤: Á∂†Â∫ï‰∫§ÁπîÁ¥ã
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,„ÄåÊë©Ê¥õËóùÂ¢É„ÄçÈô∂Áì∑ÊùØÂ¢ä Á≥ªÂàó  È°èËâ≤: Á∂†Â∫ïÈáëÊòüËäí
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,„ÄåÊë©Ê¥õËóùÂ¢É„ÄçÈô∂Áì∑ÊùØÂ¢ä Á≥ªÂàó  È°èËâ≤: Á¥ÖÂ∫ï‰∫§ÁπîÁ¥ã
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,„ÄåÊë©Ê¥õËóùÂ¢É„ÄçÈô∂Áì∑ÊùØÂ¢ä Á≥ªÂàó  È°èËâ≤: Á¥ÖÂ∫ïÁπÅËä±Á¥ã
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,„ÄåÊë©Ê¥õËóùÂ¢É„ÄçÈô∂Áì∑ÊùØÂ¢ä Á≥ªÂàó  È°èËâ≤: ÂõõËâ≤Ëä±Á£öÁ¥ã
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,„ÄåÊë©Ê¥õËóùÂ¢É„ÄçÈô∂Áì∑ÊùØÂ¢ä Á≥ªÂàó  È°èËâ≤: ÁôΩÂ∫ïÁ¥ÖÊòüËäí
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,„ÄåÊë©Ê¥õËóùÂ¢É„ÄçÈô∂Áì∑ÊùØÂ¢ä Á≥ªÂàó  È°èËâ≤: ÁôΩÂ∫ïÁ¥∞Ëä±Á¥ã
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,„ÄåÊë©Ê¥õËóùÂ¢É„ÄçÈô∂Áì∑ÊùØÂ¢ä Á≥ªÂàó  È°èËâ≤: Ëê¨Ëä±ÁπΩÁ¥õÁ¥ã
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,Áø°Áø†ÈéñÂÖâÁéâÁü≥ÊªæËº™
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,100%ÁîüÁµ≤Êë©Ê¥õÂì•ÂÇ≥Áµ±Ê≤êÊµ¥ÊâãÂ•ó
Âë®ÈÇä,ÂìÅÁâåË£Ω‰ΩúÁâ©,Êô∂ÊΩ§ÊüîËÜöÁüΩËÜ†Âà∑`;

        const CUSTOMERS_DEFAULT_CSV = `ÂÆòÁ∂≤,ÂÆòÁ∂≤
AE,AE
MO,MO
ÈõÖËôé,ÈõÖËôé
Ëù¶ÁöÆ,Ëù¶ÁöÆ
ËÇØÈ©õ,ËÇØÈ©õ
PK,PK
Âì°Ë≥º,Âì°Ë≥º
ÂÖ∂‰ªñ,ÂÖ∂‰ªñ`;

        // ÂÖ®ÂüüËÆäÊï∏
        let PRODUCTS = [];
        let CUSTOMERS = [];
        let cart = [];
        let opSign = 'sub';

        // Â∑•ÂÖ∑ÂáΩÊï∏
        function slug(str) {
            return (str || "").toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
        }

        function parseCSV(text) {
            if (!text || !text.trim()) return [];
            
            const rows = [];
            const lines = text.replace(/\r/g, '').split(/\n+/);
            
            for (let line of lines) {
                line = line.trim();
                if (!line) continue;
                
                const row = [];
                let current = '';
                let inQuotes = false;
                
                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    const nextChar = line[i + 1];
                    
                    if (char === '"') {
                        if (inQuotes && nextChar === '"') {
                            current += '"';
                            i++; // skip next quote
                        } else {
                            inQuotes = !inQuotes;
                        }
                    } else if (!inQuotes && (char === ',' || char === 'Ôºå' || char === ';' || char === '\t')) {
                        row.push(current.trim());
                        current = '';
                    } else {
                        current += char;
                    }
                }
                
                row.push(current.trim());
                if (row.length >= 2) {
                    rows.push(row);
                }
            }
            
            return rows;
        }

        function saveLocal() {
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify({
                    PRODUCTS,
                    CUSTOMERS
                }));
            } catch (e) {
                console.error('Failed to save to localStorage:', e);
            }
        }

        function loadLocal() {
            try {
                const data = localStorage.getItem(STORAGE_KEY);
                if (data) {
                    const parsed = JSON.parse(data);
                    if (parsed.PRODUCTS && parsed.CUSTOMERS) {
                        PRODUCTS = parsed.PRODUCTS;
                        CUSTOMERS = parsed.CUSTOMERS;
                        return true;
                    }
                }
            } catch (e) {
                console.error('Failed to load from localStorage:', e);
            }
            return false;
        }

        function clearLocal() {
            localStorage.removeItem(STORAGE_KEY);
            initializeDefaultData();
            renderAll();
            showToast('Êú¨Ê©üÂÑ≤Â≠òÂ∑≤Ê∏ÖÈô§ÔºåÂ∑≤ÈÇÑÂéüÈ†êË®≠Ë≥áÊñô', 'success');
        }

        function initializeDefaultData() {
            const productRows = parseCSV(PRODUCTS_DEFAULT_CSV);
            PRODUCTS = productRows.map(([A, B, C]) => ({ A: A || '', B: B || '', C: C || '' }));
            
            const customerRows = parseCSV(CUSTOMERS_DEFAULT_CSV);
            CUSTOMERS = customerRows.map(([id, name]) => ({ id: id || '', name: name || '' }));
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }

        function generateFormDateId() {
            const formDateIdInput = document.getElementById('formDateId');
            
            // ÁîüÊàêÊôÇÈñìÊà≥
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            
            const dateTimeStr = `${year}${month}${day}-${hours}${minutes}`;
            let formDateId;
            
            if (MODE === 'sales') {
                const customerSelect = document.getElementById('selCustomer');
                if (!customerSelect.value) {
                    formDateIdInput.value = '';
                    updateOrderPreview();
                    return;
                }
                // ÊâæÂà∞ÂÆ¢Êà∂ÂêçÁ®±
                const selectedCustomer = CUSTOMERS.find(c => c.id === customerSelect.value);
                const customerName = selectedCustomer ? selectedCustomer.name : customerSelect.value;
                formDateId = `${customerName}-${dateTimeStr}`;
            } else {
                // ÈùûÈä∑ÂîÆÊ®°ÂºèÔºö‰æùÈ°ûÂà•ÁîüÊàêÂâçÁ∂¥
                const selNonSalesCategory = document.getElementById('selNonSalesCategory');
                if (!selNonSalesCategory.value) {
                    formDateIdInput.value = '';
                    updateOrderPreview();
                    return;
                }
                
                // ‰ΩøÁî®ÂØ¶ÈöõÁöÑ‰∏≠ÊñáÈ°ûÂà•ÂêçÁ®±‰ΩúÁÇ∫ÂâçÁ∂¥
                const selectedCat = NON_SALES_CATEGORIES.find(c => c.id === selNonSalesCategory.value);
                const prefix = selectedCat ? selectedCat.name : 'NS';
                formDateId = `${prefix}-${dateTimeStr}`;
            }
            
            formDateIdInput.value = formDateId;
            updateOrderPreview();
        }

        function renderMode() {
            const groupCustomer = document.getElementById('groupCustomer');
            const nonSalesFields = document.getElementById('nonSalesFields');
            const opSignSection = document.getElementById('opSignSection');
            const poInput = document.getElementById('po');
            
            if (MODE === 'sales') {
                // Èä∑ÂîÆÊ®°ÂºèÔºöÈ°ØÁ§∫ÂÆ¢Êà∂ÈÅ∏ÊìáÔºåÈö±ËóèÈùûÈä∑ÂîÆÊ¨Ñ‰Ωç
                groupCustomer.style.display = 'flex';
                nonSalesFields.style.display = 'none';
                poInput.readOnly = false;
                poInput.style.background = '#fff';
                // ÂàáÊèõÂõûÈä∑ÂîÆÊ®°ÂºèÊôÇÔºåÊ∏ÖÁ©∫POÊ¨Ñ‰ΩçÔºàÂ¶ÇÊûúÁõÆÂâçÊòØ"-"Ôºâ
                if (poInput.value === '-') {
                    poInput.value = '';
                }
                opSignSection.style.display = 'flex';
            } else {
                // ÈùûÈä∑ÂîÆÊ®°ÂºèÔºöÈö±ËóèÂÆ¢Êà∂ÈÅ∏ÊìáÔºåÈ°ØÁ§∫ÈùûÈä∑ÂîÆÊ¨Ñ‰Ωç
                groupCustomer.style.display = 'none';
                nonSalesFields.style.display = 'block';
                poInput.value = '-';
                poInput.readOnly = true;
                poInput.style.background = '#f8f9fa';
                
                // Â°´ÂÖ•ÈùûÈä∑ÂîÆÈ°ûÂà•
                const selNonSalesCategory = document.getElementById('selNonSalesCategory');
                selNonSalesCategory.innerHTML = '<option value="">Ë´ãÈÅ∏ÊìáÈ°ûÂà•</option>';
                NON_SALES_CATEGORIES.sort((a, b) => a.order - b.order).forEach(cat => {
                    const option = document.createElement('option');
                    option.value = cat.id; // ‰∏≠ÊñáÂÄº
                    option.textContent = cat.name; // ‰∏≠ÊñáÈ°ØÁ§∫
                    option.dataset.defaultSign = cat.defaultSign;
                    selNonSalesCategory.appendChild(option);
                });
                
                // Êõ¥Êñ∞Êìç‰ΩúÂàáÊèõÁöÑÈ°ØÁ§∫
                updateOpSignVisibility();
            }
            
            // ÈáçÊñ∞ÁîüÊàêË°®ÂñÆID (Ê∏ÖÁ©∫ÁèæÊúâÂÄº‰ª•Âº∑Âà∂ÈáçÊñ∞ÁîüÊàê)
            document.getElementById('formDateId').value = '';
            generateFormDateId();
            updateOrderPreview();
        }
        
        function updateOpSignVisibility() {
            const selNonSalesCategory = document.getElementById('selNonSalesCategory');
            const opSignSection = document.getElementById('opSignSection');
            
            if (MODE === 'non_sales' && selNonSalesCategory.value) {
                const selectedOption = selNonSalesCategory.options[selNonSalesCategory.selectedIndex];
                const defaultSign = selectedOption.dataset.defaultSign;
                
                if (defaultSign === 'plus') {
                    opSignSection.style.display = 'none';
                    opSign = 'add';
                } else if (defaultSign === 'minus') {
                    opSignSection.style.display = 'none';
                    opSign = 'sub';
                } else {
                    opSignSection.style.display = 'flex';
                }
            } else {
                opSignSection.style.display = 'flex';
            }
        }

        function updateOrderPreview() {
            const customerSelect = document.getElementById('selCustomer');
            const poInput = document.getElementById('po');
            const formDateIdInput = document.getElementById('formDateId');
            
            // ÂèñÂæóÈ†êË¶ΩË°åÂÖÉÁ¥†
            const previewRows = document.querySelectorAll('.preview-row');
            
            if (MODE === 'sales') {
                // Èä∑ÂîÆÊ®°ÂºèÈ†êË¶Ω - Á¢∫‰øùÊ≠£Á¢∫ÁöÑÊ®ôÁ±§ÔºåÈö±ËóèÈùûÈä∑ÂîÆÂ∞àÁî®Ë°å
                if (previewRows.length >= 5) {
                    previewRows[0].querySelector('.preview-label').textContent = 'Âá∫Ë≤®ÂÆ¢Êà∂:';
                    previewRows[1].querySelector('.preview-label').textContent = 'PO Âá∫Ë≤®ÂñÆËôü:';
                    previewRows[2].querySelector('.preview-label').textContent = 'Âá∫Ë≤®ÂñÆ_Êó•Êúü_ID:';
                    
                    // Èö±ËóèÁ∑äÊÄ•Á®ãÂ∫¶ÂíåÂÇôË®ªË°åÔºàÈùûÈä∑ÂîÆÂ∞àÁî®Ôºâ
                    previewRows[3].style.display = 'none';
                    previewRows[4].style.display = 'none';
                }
                
                const previewCustomer = document.getElementById('previewCustomer');
                if (customerSelect.value) {
                    const selectedCustomer = CUSTOMERS.find(c => c.id === customerSelect.value);
                    previewCustomer.textContent = selectedCustomer ? selectedCustomer.name : customerSelect.value;
                } else {
                    previewCustomer.textContent = 'Ë´ãÈÅ∏ÊìáÂÆ¢Êà∂';
                }
                
                const previewPO = document.getElementById('previewPO');
                previewPO.textContent = poInput.value.trim() || 'Ë´ãËº∏ÂÖ• PO Á∑®Ëôü';
            } else {
                // ÈùûÈä∑ÂîÆÊ®°ÂºèÈ†êË¶Ω
                const selNonSalesCategory = document.getElementById('selNonSalesCategory');
                const selUrgency = document.getElementById('selUrgency');
                const txtNote = document.getElementById('txtNote');
                
                // Êõ¥Êñ∞È†êË¶ΩÊ®ôÁ±§ÂíåÂÖßÂÆπ - È°ØÁ§∫ÊâÄÊúâË°å
                if (previewRows.length >= 5) {
                    // Á¨¨‰∏ÄË°åÔºöÈùûÈä∑ÂîÆÈ°ûÂà•
                    previewRows[0].querySelector('.preview-label').textContent = 'ÈùûÈä∑ÂîÆÈ°ûÂà•:';
                    if (selNonSalesCategory.value) {
                        const selectedCat = NON_SALES_CATEGORIES.find(c => c.id === selNonSalesCategory.value);
                        previewRows[0].querySelector('.preview-value').textContent = selectedCat ? selectedCat.id : 'Ë´ãÈÅ∏ÊìáÈ°ûÂà•';
                    } else {
                        previewRows[0].querySelector('.preview-value').textContent = 'Ë´ãÈÅ∏ÊìáÈ°ûÂà•';
                    }
                    
                    // Á¨¨‰∫åË°åÔºöPO Á∑®ËôüÔºàÂõ∫ÂÆöÈ°ØÁ§∫ "-"Ôºâ
                    previewRows[1].querySelector('.preview-label').textContent = 'PO Âá∫Ë≤®ÂñÆËôü:';
                    previewRows[1].querySelector('.preview-value').textContent = '-';
                    
                    // Á¨¨‰∏âË°åÔºöÂá∫Ë≤®ÂñÆ_Êó•Êúü_ID
                    previewRows[2].querySelector('.preview-label').textContent = 'Âá∫Ë≤®ÂñÆ_Êó•Êúü_ID:';
                    
                    // Á¨¨ÂõõË°åÔºöÁ∑äÊÄ•Á®ãÂ∫¶
                    const urgencyLabels = { '0': '‰∏ÄËà¨', '1': 'ÂÑ™ÂÖà', '2': 'ÊÄ•‰ª∂' };
                    previewRows[3].querySelector('.preview-label').textContent = 'Á∑äÊÄ•Á®ãÂ∫¶:';
                    previewRows[3].querySelector('.preview-value').textContent = urgencyLabels[selUrgency.value] || '‰∏ÄËà¨';
                    previewRows[3].style.display = 'flex';
                    
                    // Á¨¨‰∫îË°åÔºöÂÇôË®ª
                    previewRows[4].querySelector('.preview-label').textContent = 'ÂÇôË®ª:';
                    previewRows[4].querySelector('.preview-value').textContent = txtNote.value.trim() || 'ÁÑ°';
                    previewRows[4].style.display = 'flex';
                }
            }
            
            // Êõ¥Êñ∞Ë°®ÂñÆIDÈ†êË¶Ω
            const previewFormDateId = document.getElementById('previewFormDateId');
            previewFormDateId.textContent = formDateIdInput.value || 'ÂæÖÁîüÊàê';
        }

        // Ê∏≤ÊüìÂáΩÊï∏
        function renderCustomers() {
            const select = document.getElementById('selCustomer');
            select.innerHTML = '<option value="">Ë´ãÈÅ∏ÊìáÂÆ¢Êà∂</option>';
            
            // ‰øùÊåÅÂéüÂßã‰∏äÂÇ≥È†ÜÂ∫èÔºå‰∏çÈÄ≤Ë°åÊéíÂ∫è
            CUSTOMERS.forEach(customer => {
                const option = document.createElement('option');
                option.value = customer.id;
                option.textContent = customer.name;
                select.appendChild(option);
            });
        }

        function renderFilters() {
            // ‰øùÊåÅÂéüÂßã‰∏äÂÇ≥È†ÜÂ∫èÁöÑÂéªÈáçËôïÁêÜ
            const seenCategories = new Set();
            const seenSeries = new Set();
            const categories = [];
            const series = [];
            
            // ÊåâÂéüÂßãÈ†ÜÂ∫èÂèñÂæóÂìÅÈ°ûÂíåÁ≥ªÂàó
            PRODUCTS.forEach(p => {
                if (!seenCategories.has(p.A)) {
                    seenCategories.add(p.A);
                    categories.push(p.A);
                }
                if (!seenSeries.has(p.B)) {
                    seenSeries.add(p.B);
                    series.push(p.B);
                }
            });
            
            // Áî¢ÂìÅÊåâÂéüÂßãÈ†ÜÂ∫è
            const products = [...PRODUCTS];
            
            // ÂìÅÈ°û‰∏ãÊãâ
            const catSelect = document.getElementById('selCategory');
            catSelect.innerHTML = '<option value="">ÂÖ®ÈÉ®ÂìÅÈ°û</option>';
            categories.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                catSelect.appendChild(option);
            });
            
            // Á≥ªÂàó‰∏ãÊãâ
            const serSelect = document.getElementById('selSeries');
            serSelect.innerHTML = '<option value="">ÂÖ®ÈÉ®Á≥ªÂàó</option>';
            series.forEach(ser => {
                const option = document.createElement('option');
                option.value = ser;
                option.textContent = ser;
                serSelect.appendChild(option);
            });
            
            // Áî¢ÂìÅ‰∏ãÊãâ
            const prodSelect = document.getElementById('selProduct');
            prodSelect.innerHTML = '<option value="">Ë´ãÈÅ∏ÊìáÁî¢ÂìÅ</option>';
            products.forEach(prod => {
                const option = document.createElement('option');
                option.value = JSON.stringify(prod);
                option.textContent = prod.C;
                prodSelect.appendChild(option);
            });
        }

        function filterProducts() {
            const categoryValue = document.getElementById('selCategory').value;
            const seriesValue = document.getElementById('selSeries').value;
            
            let filtered = [...PRODUCTS];
            
            if (categoryValue) {
                filtered = filtered.filter(p => p.A === categoryValue);
            }
            
            if (seriesValue) {
                filtered = filtered.filter(p => p.B === seriesValue);
            }
            
            // ÁßªÈô§Â≠óÊØçÊéíÂ∫èÔºåÁ∂≠ÊåÅÂéüÂßã‰∏äÂÇ≥È†ÜÂ∫è
            
            const prodSelect = document.getElementById('selProduct');
            prodSelect.innerHTML = '<option value="">Ë´ãÈÅ∏ÊìáÁî¢ÂìÅ</option>';
            
            filtered.forEach(prod => {
                const option = document.createElement('option');
                option.value = JSON.stringify(prod);
                option.textContent = prod.C;
                prodSelect.appendChild(option);
            });
        }

        function renderCart() {
            const tbody = document.querySelector('#cartTable tbody');
            tbody.innerHTML = '';
            
            cart.forEach((item, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.C}</td>
                    <td>
                        <div class="qty-controls">
                            <button class="qty-btn" onclick="updateCartQty(${index}, -1)">‚àí</button>
                            <input type="number" class="qty-input" value="${item.qty}" min="1" onchange="setCartQty(${index}, this.value)">
                            <button class="qty-btn" onclick="updateCartQty(${index}, 1)">+</button>
                        </div>
                    </td>
                    <td>
                        <button class="btn btn-danger" onclick="removeFromCart(${index})">Âà™Èô§</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            // Êõ¥Êñ∞Áµ±Ë®à
            document.getElementById('totalItems').textContent = cart.length;
            document.getElementById('totalQty').textContent = cart.reduce((sum, item) => sum + item.qty, 0);
        }

        function renderBundles() {
            const select = document.getElementById('selBundle');
            select.innerHTML = '<option value="">Ë´ãÈÅ∏ÊìáÂ•óÁµÑ</option>';
            
            BUNDLES.forEach(bundle => {
                const option = document.createElement('option');
                option.value = bundle.id;
                option.textContent = bundle.name;
                select.appendChild(option);
            });
        }

        function renderAll() {
            renderCustomers();
            renderFilters();
            renderBundles();
            renderCart();
        }

        // ‰∫ã‰ª∂ËôïÁêÜ
        function updateCartQty(index, change) {
            cart[index].qty = Math.max(1, cart[index].qty + change);
            renderCart();
        }

        function setCartQty(index, value) {
            const qty = parseInt(value) || 1;
            cart[index].qty = Math.max(1, qty);
            renderCart();
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            renderCart();
            showToast('Â∑≤ÂæûÊ∏ÖÂñÆ‰∏≠ÁßªÈô§', 'success');
        }

        function addToCart() {
            const productSelect = document.getElementById('selProduct');
            const qtyInput = document.getElementById('qty');
            
            if (!productSelect.value) {
                showToast('Ë´ãÈÅ∏ÊìáÁî¢ÂìÅ', 'error');
                return;
            }
            
            const product = JSON.parse(productSelect.value);
            const qty = Math.max(1, parseInt(qtyInput.value) || 1);
            
            // Ê™¢Êü•ÊòØÂê¶Â∑≤Â≠òÂú®
            const existingIndex = cart.findIndex(item => 
                item.A === product.A && item.B === product.B && item.C === product.C
            );
            
            if (existingIndex >= 0) {
                cart[existingIndex].qty += qty;
                showToast('Êï∏ÈáèÂ∑≤Á¥ØÂä†', 'success');
            } else {
                cart.push({ ...product, qty });
                showToast('Â∑≤Âä†ÂÖ•Ê∏ÖÂñÆ', 'success');
            }
            
            renderCart();
            qtyInput.value = 1;
        }

        function addBundleToCart() {
            const bundleSelect = document.getElementById('selBundle');
            const bundleQtyInput = document.getElementById('bundleQty');
            
            if (!bundleSelect.value) {
                showToast('Ë´ãÈÅ∏ÊìáÂ•óÁµÑ', 'error');
                return;
            }
            
            const selectedBundle = BUNDLES.find(b => b.id === bundleSelect.value);
            if (!selectedBundle) {
                showToast('Â•óÁµÑ‰∏çÂ≠òÂú®', 'error');
                return;
            }
            
            const bundleQty = Math.max(1, parseInt(bundleQtyInput.value) || 1);
            let addedCount = 0;
            
            selectedBundle.items.forEach(bundleItem => {
                // Â∞á productKey ËΩâÊèõÁÇ∫Áî¢ÂìÅÂ∞çË±°
                const [A, B, C] = bundleItem.productKey.split('__');
                const product = { A, B, C };
                const totalQty = bundleItem.qtyPerBundle * bundleQty;
                
                // Ê™¢Êü•Áî¢ÂìÅÊòØÂê¶Â≠òÂú®Êñº PRODUCTS ‰∏≠
                const productExists = PRODUCTS.find(p => p.A === A && p.B === B && p.C === C);
                if (!productExists) {
                    showToast(`Â•óÁµÑ‰∏≠ÁöÑÁî¢ÂìÅ„Äå${C}„Äç‰∏çÂ≠òÂú®ÊñºÂïÜÂìÅÊ∏ÖÂñÆ‰∏≠`, 'error');
                    return;
                }
                
                // Ê™¢Êü•ÊòØÂê¶Â∑≤Â≠òÂú®ÊñºË≥ºÁâ©Ëªä
                const existingIndex = cart.findIndex(item => 
                    item.A === A && item.B === B && item.C === C
                );
                
                if (existingIndex >= 0) {
                    cart[existingIndex].qty += totalQty;
                } else {
                    cart.push({ ...product, qty: totalQty });
                }
                addedCount++;
            });
            
            if (addedCount > 0) {
                renderCart();
                showToast(`Â∑≤Âä†ÂÖ•Â•óÁµÑ„Äå${selectedBundle.name}„Äç√ó${bundleQty}`, 'success');
                bundleQtyInput.value = 1;
            }
        }

        function clearCart() {
            if (cart.length === 0) {
                showToast('Ê∏ÖÂñÆÂ∑≤Á∂ìÊòØÁ©∫ÁöÑ', 'error');
                return;
            }
            
            if (confirm('Á¢∫ÂÆöË¶ÅÊ∏ÖÁ©∫Ê∏ÖÂñÆÂóéÔºüÂè™ÊúÉÊ∏ÖÈô§ÂïÜÂìÅÊ∏ÖÂñÆÔºå‰∏çÂΩ±ÈüøÂÖ∂‰ªñËº∏ÂÖ•Ê¨Ñ‰Ωç„ÄÇ')) {
                cart = [];
                renderCart();
                showToast('ÂïÜÂìÅÊ∏ÖÂñÆÂ∑≤Ê∏ÖÁ©∫', 'success');
            }
        }

        function submitOrder() {
            const formDateIdInput = document.getElementById('formDateId');
            
            if (cart.length === 0) {
                showToast('Ê∏ÖÂñÆÊòØÁ©∫ÁöÑ', 'error');
                return;
            }
            
            // Ê†πÊìöÊ®°ÂºèÈÄ≤Ë°å‰∏çÂêåÁöÑÈ©óË≠â
            if (MODE === 'sales') {
                const customerSelect = document.getElementById('selCustomer');
                const poInput = document.getElementById('po');
                
                if (!customerSelect.value) {
                    showToast('Ë´ãÈÅ∏ÊìáÂá∫Ë≤®ÂÆ¢Êà∂', 'error');
                    return;
                }
                
                if (!poInput.value.trim()) {
                    showToast('Ë´ãËº∏ÂÖ• PO Âá∫Ë≤®ÂñÆËôü', 'error');
                    return;
                }
            } else {
                const selNonSalesCategory = document.getElementById('selNonSalesCategory');
                
                if (!selNonSalesCategory.value) {
                    showToast('Ë´ãÈÅ∏ÊìáÈùûÈä∑ÂîÆÈ°ûÂà•', 'error');
                    return;
                }
            }
            
            // Ë®àÁÆó delta Á∏ΩÂíå
            let totalDelta = 0;
            const itemsWithDelta = cart.map(item => {
                let delta;
                if (MODE === 'sales') {
                    delta = -item.qty; // Èä∑ÂîÆÊ®°ÂºèÂõ∫ÂÆöÁÇ∫Ë≤†ÂÄºÔºàÂá∫Ë≤®Ôºâ
                } else {
                    const selNonSalesCategory = document.getElementById('selNonSalesCategory');
                    const selectedOption = selNonSalesCategory.options[selNonSalesCategory.selectedIndex];
                    const defaultSign = selectedOption.dataset.defaultSign;
                    
                    if (defaultSign === 'plus') {
                        delta = +item.qty;
                    } else if (defaultSign === 'minus') {
                        delta = -item.qty;
                    } else {
                        // defaultSign === 'any'Ôºå‰æùÁÖß opSign Ê±∫ÂÆö
                        delta = opSign === 'add' ? +item.qty : -item.qty;
                    }
                }
                totalDelta += delta;
                
                return {
                    id: `${slug(item.A)}__${slug(item.B)}__${slug(item.C)}`,
                    category: item.A,
                    series: item.B,
                    product: item.C,
                    delta: delta
                };
            });
            
            // ÂâµÂª∫Á¢∫Ë™çË®äÊÅØ
            let confirmMessage;
            if (MODE === 'sales') {
                const customerSelect = document.getElementById('selCustomer');
                const poInput = document.getElementById('po');
                const selectedCustomer = CUSTOMERS.find(c => c.id === customerSelect.value);
                const customerName = selectedCustomer ? selectedCustomer.name : customerSelect.value;
                
                confirmMessage = `üöÄ Á¢∫Ë™çË¶ÅÊèê‰∫§Â∫´Â≠òÊõ¥Êñ∞ÂóéÔºü

Ê®°Âºè: Èä∑ÂîÆ (Sales)
üì¶ Âá∫Ë≤®ÂÆ¢Êà∂: ${customerName}
üìã PO Âá∫Ë≤®ÂñÆËôü: ${poInput.value.trim()}
üÜî Âá∫Ë≤®ÂñÆ_Êó•Êúü_ID: ${formDateIdInput.value}

üìä ÂïÜÂìÅÈ†ÖÁõÆ: ${cart.length} È†Ö
üìä Â∫´Â≠òÁï∞ÂãïÁ∏ΩÈáè: ${totalDelta}

‚ö†Ô∏è Ê≠§Êìç‰ΩúÂ∞áÊúÉÊèê‰∫§Âà∞Â∫´Â≠òÊõ¥Êñ∞Á≥ªÁµ±ÔºåÁ¢∫ÂÆöË¶ÅÁπºÁ∫åÂóéÔºü`;
            } else {
                const selNonSalesCategory = document.getElementById('selNonSalesCategory');
                const selUrgency = document.getElementById('selUrgency');
                const txtNote = document.getElementById('txtNote');
                const selectedCat = NON_SALES_CATEGORIES.find(c => c.id === selNonSalesCategory.value);
                
                confirmMessage = `üöÄ Á¢∫Ë™çË¶ÅÊèê‰∫§Â∫´Â≠òÊõ¥Êñ∞ÂóéÔºü

Ê®°Âºè: ÈùûÈä∑ÂîÆ (Non-Sales)
üìã È°ûÂà•: ${selectedCat ? selectedCat.id : 'Êú™Áü•'}
‚ö° Á∑äÊÄ•Á®ãÂ∫¶: ${selUrgency.value}
üìù ÂÇôË®ª: ${txtNote.value || 'ÁÑ°'}
üÜî Ë°®ÂñÆ_Êó•Êúü_ID: ${formDateIdInput.value}

üìä ÂïÜÂìÅÈ†ÖÁõÆ: ${cart.length} È†Ö
üìä Â∫´Â≠òÁï∞ÂãïÁ∏ΩÈáè: ${totalDelta}

‚ö†Ô∏è Ê≠§Êìç‰ΩúÂ∞áÊúÉÊèê‰∫§Âà∞Â∫´Â≠òÊõ¥Êñ∞Á≥ªÁµ±ÔºåÁ¢∫ÂÆöË¶ÅÁπºÁ∫åÂóéÔºü`;
            }
            
            if (!confirm(confirmMessage)) {
                return;
            }
            
            
            // Âª∫Á´ãÁµ±‰∏Ä payload
const mode = MODE; // 'sales' | 'non_sales'
            const poVal = (mode === 'sales' ? (document.getElementById('po').value || '').trim() : '-');
            const noteVal = (document.getElementById('txtNote')?.value || '').trim(); // ÈùûÈä∑ÂîÆÊôÇÂøÖÂ°´ÂèØÂú® UI È©óË≠â

            const payload = {
                action: "inventory_update",
                mode,
                // ‚Äî‚Äî ÈùûÈä∑ÂîÆÂ∞àÂ±¨Ê¨Ñ‰ΩçÔºàÈä∑ÂîÆ‰πüË¶ÅÊúâ noteÔºå‰ΩÜÂèØÁÇ∫Á©∫Ôºâ‚Äî‚Äî
                ...(mode === 'non_sales' ? {
                    categoryId: document.getElementById('selNonSalesCategory').value || "",
                    urgency: parseInt(document.getElementById('selUrgency').value || "0", 10)
                } : {}),
                note: noteVal,
                // ‚Äî‚Äî Ë®ÇÂñÆË≥áÊñô ‚Äî‚Äî 
                order: {
                    customerId: (mode === 'sales'
                        ? (document.getElementById('selCustomer').value || "")
                        : (document.getElementById('selNonSalesCategory').value || "")), // ÈùûÈä∑ÂîÆÁî®È°ûÂà•IDÂç†‰Ωç
                    category: (mode === 'non_sales' ? document.getElementById('selNonSalesCategory').value || "" : ""),
                    po: poVal,
                    docId: (document.getElementById('formDateId').value || "").trim()
                },
                // ‚Äî‚Äî ÊòéÁ¥∞ÔºàË´ãÁ¢∫‰øùÂê´ product Ëàá deltaÔºâ‚Äî‚Äî
                items: cart.map(p => ({
                    id: p.id || `${slug(p.A)}__${slug(p.B)}__${slug(p.C)}`,
                    category: p.A,
                    series: p.B,
                    product: p.C,
                    delta: (mode === 'sales' ? -(p.qty||0) : (p.delta || (p.qty||0))) // ‰ΩøÁî®Ë®àÁÆóÂ•ΩÁöÑ delta
                })),
                // ‚Äî‚Äî Âêà‰ΩµÊ¨Ñ‰ΩçÔºàÁµ¶ Make Áõ¥Êé• mappingÔºâ‚Äî‚Äî
                meta: {
                    noteCombined: [poVal, noteVal].filter(Boolean).join(" | ")
                }
            };

            // ÈÄÅÂá∫ÂâçË´ãÂä†ÈÄôË°åÈô§ÈåØÔºö
            console.log('[DEBUG payload]', JSON.stringify(payload, null, 2));
            
            fetch(WEBHOOK_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(payload)
            })
            .then(response => {
                if (response.ok) {
                    showToast('‚úÖ Â∫´Â≠òÊõ¥Êñ∞Êèê‰∫§ÊàêÂäüÔºÅ', 'success');
                } else {
                    throw new Error('Network response was not ok');
                }
            })
            .catch(error => {
                console.error('Submit error:', error);
                showToast('‚ùå Êèê‰∫§Â§±ÊïóÔºåË´ãÁ®çÂæåÂÜçË©¶', 'error');
            });
        }

        function resetAllData() {
            if (!confirm('üîÑ Á¢∫ÂÆöË¶ÅÈáçÁΩÆÊâÄÊúâË≥áÊñôÂóéÔºüÈÄôÂ∞áÊÅ¢Âæ©Âà∞Á≥ªÁµ±ÂàùÂßãÁãÄÊÖãÔºÅ')) {
                return;
            }
            
            // ÈáçÁΩÆÊ®°ÂºèÁÇ∫Èä∑ÂîÆ
            MODE = 'sales';
            document.querySelector('input[name="mode"][value="sales"]').checked = true;
            
            // Ê∏ÖÁ©∫Ë°®ÂñÆÊ¨Ñ‰Ωç
            document.getElementById('selCustomer').value = '';
            document.getElementById('po').value = '';
            document.getElementById('formDateId').value = '';
            
            // Ê∏ÖÁ©∫ÈùûÈä∑ÂîÆÊ¨Ñ‰Ωç
            document.getElementById('selNonSalesCategory').value = '';
            document.getElementById('selUrgency').value = '0';
            document.getElementById('txtNote').value = '';
            
            // Ê∏ÖÁ©∫Ë≥ºÁâ©Ëªä
            cart = [];
            
            // ÈáçÁΩÆÁî¢ÂìÅÁØ©ÈÅ∏ÁÇ∫È†êË®≠ÂÄº
            document.getElementById('selCategory').value = '';
            document.getElementById('selSeries').value = '';
            document.getElementById('selProduct').value = '';
            document.getElementById('qty').value = '1';
            
            // ÈáçÁΩÆÊìç‰ΩúÈ°ûÂûãÁÇ∫Âá∫Ë≤®
            opSign = 'sub';
            document.querySelector('input[name="opSign"][value="sub"]').checked = true;
            
            // ÈáçÊñ∞Ê∏≤ÊüìÊâÄÊúâÁµÑ‰ª∂
            renderMode();  // ÈÄôÊúÉËôïÁêÜÊ®°ÂºèÁõ∏ÈóúÁöÑÈ°ØÁ§∫/Èö±Ëóè
            renderCart();
            updateOrderPreview();
            filterProducts();
            
            showToast('üîÑ Â∑≤ÈáçÁΩÆÂà∞Á≥ªÁµ±ÂàùÂßãÁãÄÊÖã', 'success');
        }

        // CSV ÂåØÂÖ•ËôïÁêÜ
        function importProducts() {
            const csvText = document.getElementById('csvABC').value.trim();
            if (!csvText) {
                showToast('Ë´ãËº∏ÂÖ•ÂïÜÂìÅ CSV Ë≥áÊñô', 'error');
                return;
            }
            
            try {
                const rows = parseCSV(csvText);
                PRODUCTS = rows.map(([A, B, C]) => ({ A: A || '', B: B || '', C: C || '' }));
                saveLocal();
                renderFilters();
                showToast(`Â∑≤ËºâÂÖ• ${PRODUCTS.length} ÂÄãÂïÜÂìÅ`, 'success');
            } catch (error) {
                showToast('ÂïÜÂìÅ CSV Ê†ºÂºèÈåØË™§', 'error');
            }
        }

        function importCustomers() {
            const csvText = document.getElementById('csvCus').value.trim();
            if (!csvText) {
                showToast('Ë´ãËº∏ÂÖ•ÂÆ¢Êà∂ CSV Ë≥áÊñô', 'error');
                return;
            }
            
            try {
                const rows = parseCSV(csvText);
                CUSTOMERS = rows.map(([id, name]) => ({ id: id || '', name: name || '' }));
                saveLocal();
                renderCustomers();
                showToast(`Â∑≤ËºâÂÖ• ${CUSTOMERS.length} ÂÄãÂÆ¢Êà∂`, 'success');
            } catch (error) {
                showToast('ÂÆ¢Êà∂ CSV Ê†ºÂºèÈåØË™§', 'error');
            }
        }

        function overwriteAll() {
            const productsCsv = document.getElementById('csvABC').value.trim();
            const customersCsv = document.getElementById('csvCus').value.trim();
            
            if (!productsCsv && !customersCsv) {
                showToast('Ë´ãËá≥Â∞ëËº∏ÂÖ•‰∏ÄÁ®ÆË≥áÊñô', 'error');
                return;
            }
            
            if (productsCsv) {
                try {
                    const rows = parseCSV(productsCsv);
                    PRODUCTS = rows.map(([A, B, C]) => ({ A: A || '', B: B || '', C: C || '' }));
                } catch (error) {
                    showToast('ÂïÜÂìÅ CSV Ê†ºÂºèÈåØË™§', 'error');
                    return;
                }
            }
            
            if (customersCsv) {
                try {
                    const rows = parseCSV(customersCsv);
                    CUSTOMERS = rows.map(([id, name]) => ({ id: id || '', name: name || '' }));
                } catch (error) {
                    showToast('ÂÆ¢Êà∂ CSV Ê†ºÂºèÈåØË™§', 'error');
                    return;
                }
            }
            
            saveLocal();
            renderAll();
            showToast('Ë≥áÊñôÂ∑≤Ë¶ÜËìã‰∏¶ÂÑ≤Â≠ò', 'success');
        }

        // ‰∫ã‰ª∂Á∂ÅÂÆö
        document.addEventListener('DOMContentLoaded', function() {
            // ÂàùÂßãÂåñË≥áÊñô
            if (!loadLocal()) {
                initializeDefaultData();
            }
            renderAll();
            renderMode();
            
            // Â•óÁµÑÊï∏ÈáèÊéßÂà∂
            document.getElementById('bundleInc').onclick = () => {
                const bundleQtyInput = document.getElementById('bundleQty');
                bundleQtyInput.value = Math.max(1, parseInt(bundleQtyInput.value) || 1) + 1;
            };
            
            document.getElementById('bundleDec').onclick = () => {
                const bundleQtyInput = document.getElementById('bundleQty');
                bundleQtyInput.value = Math.max(1, (parseInt(bundleQtyInput.value) || 1) - 1);
            };
            
            document.getElementById('bundleQty').onchange = function() {
                this.value = Math.max(1, parseInt(this.value) || 1);
            };
            
            // Êï∏ÈáèÊéßÂà∂
            document.getElementById('inc').onclick = () => {
                const qtyInput = document.getElementById('qty');
                qtyInput.value = Math.max(1, parseInt(qtyInput.value) || 1) + 1;
            };
            
            document.getElementById('dec').onclick = () => {
                const qtyInput = document.getElementById('qty');
                qtyInput.value = Math.max(1, (parseInt(qtyInput.value) || 1) - 1);
            };
            
            document.getElementById('qty').onchange = function() {
                this.value = Math.max(1, parseInt(this.value) || 1);
            };
            
            // ÁØ©ÈÅ∏ËÅØÂãï
            document.getElementById('selCategory').onchange = filterProducts;
            document.getElementById('selSeries').onchange = filterProducts;
            
            document.getElementById('selProduct').onchange = function() {
                if (this.value) {
                    const product = JSON.parse(this.value);
                    // ÂêåÊ≠•ÁØ©ÈÅ∏Âô®
                    document.getElementById('selCategory').value = product.A;
                    document.getElementById('selSeries').value = product.B;
                }
            };
            
            // Ê®°ÂºèÂàáÊèõ‰∫ã‰ª∂
            document.querySelectorAll('input[name="mode"]').forEach(radio => {
                radio.onchange = function() {
                    MODE = this.value;
                    renderMode();
                };
            });
            
            // Êìç‰ΩúÈ°ûÂûãÂàáÊèõ‰∫ã‰ª∂
            document.querySelectorAll('input[name="opSign"]').forEach(radio => {
                radio.onchange = function() {
                    opSign = this.value;
                };
            });
            
            // ÈùûÈä∑ÂîÆÈ°ûÂà•ËÆäÊõ¥‰∫ã‰ª∂
            document.getElementById('selNonSalesCategory').onchange = function() {
                updateOpSignVisibility();
                generateFormDateId();
                updateOrderPreview();
            };
            
            // Á∑äÊÄ•Á®ãÂ∫¶ÂíåÂÇôË®ªËÆäÊõ¥‰∫ã‰ª∂
            document.getElementById('selUrgency').onchange = updateOrderPreview;
            document.getElementById('txtNote').oninput = updateOrderPreview;
            
            // ÂÆ¢Êà∂ÈÅ∏Êìá‰∫ã‰ª∂ - Ëá™ÂãïÁîüÊàêË°®ÂñÆ_Êó•Êúü_ID
            document.getElementById('selCustomer').onchange = function() {
                generateFormDateId();
                updateOrderPreview();
            };
            
            // POÁ∑®ËôüËº∏ÂÖ•‰∫ã‰ª∂ - Êõ¥Êñ∞È†êË¶Ω
            document.getElementById('po').oninput = updateOrderPreview;
            
            // ÊåâÈàï‰∫ã‰ª∂
            document.getElementById('addBtn').onclick = addToCart;
            document.getElementById('btnAddBundle').onclick = addBundleToCart;
            document.getElementById('btnClear').onclick = clearCart;
            document.getElementById('btnSubmit').onclick = submitOrder;
            document.getElementById('btnReset').onclick = resetAllData;
            
            // ÂåØÂÖ•ÊåâÈàï
            document.getElementById('btnParseABC').onclick = importProducts;
            document.getElementById('btnParseCus').onclick = importCustomers;
            document.getElementById('btnOverwriteAll').onclick = overwriteAll;
            document.getElementById('btnClearLocal').onclick = clearLocal;
        });
    </script>
</body>
</html>
